"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4759],{24887:(j,D,t)=>{t.d(D,{Z:()=>e});var u=t(31733),L=t(51343),y=t(37739),S=t(49311);const e=(0,u.forwardRef)(function(x,w){return u.createElement(L.zx,{variant:"secondary",size:"sm",type:"button","aria-label":"more-actions","data-testid":"more-actions",ref:w,...x},u.createElement(y.K,{direction:"row",alignItems:"center",gap:0},"More ",u.createElement(S.J,{name:"angle-down"})))})},44759:(j,D,t)=>{t.r(D),t.d(D,{ContactPoint:()=>he,ContactPointReceiverSummary:()=>Ae,ContactPointReceiverTitleRow:()=>Ce,default:()=>rt});var u=t(76932),L=t(20670),y=t(69781),S=t(86504),O=t.n(S),e=t(31733),W=t(16425),x=t(83870),w=t(74011),I=t(25111),C=t(37739),N=t(88062),K=t(4981),Q=t(31805),R=t(61375),a=t(51343),c=t(36717),f=t(47808),o=t(76067),m=t(63424),i=t(58037),A=t(67669),b=t(49311),T=t(33132);const U={pagerduty:"PagerDuty",pushover:"Pushover",slack:"Slack",opsgenie:"OpsGenie",webhook:"Webhook",victorops:"VictorOps",wechat:"WeChat",discord:"Discord",webex:"Cisco Webex Teams",sns:"Amazon SNS",telegram:"Telegram",msteams:"Microsoft Teams"};var P=t(77398),H=t(67483),J=t(87768),G=t(1203),$=t(19282),ee=t(67451),re=t(99825),Se=t(98771),X=t(83010),Re=t(24887),de=t(79695),ie=t(40040),te=t(3478),me=t(15546),ue=t(10506),ge=t(8299),pe=t(21114);const Pe=({receiverName:n,decrypt:l,exportFormat:r,onClose:s})=>{const{currentData:d="",isFetching:g}=me.alertRuleApi.useExportReceiverQuery({receiverName:n,decrypt:l,format:r}),v=`cp-${n}-${new Date().getTime()}`;return g?e.createElement(R.u,{text:"Loading...."}):e.createElement(ue.u,{format:r,textDefinition:d,downloadFileName:v,onClose:s})},Te=({onClose:n,receiverName:l,decrypt:r})=>{const[s,d]=(0,e.useState)("yaml");return e.createElement(ge.i,{activeTab:s,onTabChange:d,onClose:n,formatProviders:Object.values(pe.uN)},e.createElement(Pe,{receiverName:l,decrypt:r,exportFormat:s,onClose:n}))},De=({decrypt:n,exportFormat:l,onClose:r})=>{const{currentData:s="",isFetching:d}=me.alertRuleApi.useExportReceiversQuery({decrypt:n,format:l}),g=`contact-points-${new Date().getTime()}`;return d?e.createElement(R.u,{text:"Loading...."}):e.createElement(ue.u,{format:l,textDefinition:s,downloadFileName:g,onClose:r})},Le=({onClose:n,decrypt:l})=>{const[r,s]=(0,e.useState)("yaml");return e.createElement(ge.i,{activeTab:r,onTabChange:s,onClose:n,formatProviders:Object.values(pe.uN)},e.createElement(De,{decrypt:l,exportFormat:r,onClose:n}))},xe=({metadata:{icon:n,title:l,externalUrl:r,warning:s}})=>{const d=(0,o.wW)(Ie);return e.createElement(C.K,{alignItems:"center",gap:.5},e.createElement(C.K,{direction:"row",alignItems:"center",gap:.5},s?e.createElement(i.u,{content:s,theme:"error"},e.createElement(b.J,{name:"exclamation-triangle",className:d.warnIcon})):e.createElement("img",{src:n,alt:l,height:"16px"}),e.createElement("span",null,l)),r&&e.createElement(a.Qj,{icon:"external-link-alt",href:r,target:"_blank",variant:"secondary",size:"sm"}))},Ie=n=>({warnIcon:(0,u.css)({fill:n.colors.warning.text})});var Me=t(3889),Oe=t(90069),Ne=t(42342),q=t(76085),Fe=t(84415),Ke=t(37365),ne=t(66172),Be=t(93820),We=t(24507),ae=t(74086),Ue=t(33143);const we=({config:n,alertManagerName:l})=>{const r=(0,Ne.useDispatch)(),[s,d]=(0,e.useState)({}),g=(0,o.wW)(Ke.D),v=(0,e.useMemo)(()=>Object.entries(n.template_files).map(([F,M])=>({name:F,template:M,provenance:(n.template_file_provenances??{})[F]})),[n]),[p,E]=(0,e.useState)(),B=()=>{p&&r((0,Fe.S6)(p,l)),E(void 0)};return e.createElement(e.Fragment,null,e.createElement("table",{className:g.table,"data-testid":"templates-table"},e.createElement("colgroup",null,e.createElement("col",{className:g.colExpand}),e.createElement("col",null),e.createElement("col",null)),e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null),e.createElement("th",null,"Template"),e.createElement(q.q,{actions:[P.oI.CreateNotificationTemplate,P.oI.UpdateNotificationTemplate,P.oI.DeleteNotificationTemplate]},e.createElement("th",null,"Actions")))),e.createElement("tbody",null,!v.length&&e.createElement("tr",{className:g.evenRow},e.createElement("td",{colSpan:3},"No templates defined.")),v.map(({name:h,template:F,provenance:M},z)=>{const V=!!s[h];return e.createElement(e.Fragment,{key:h},e.createElement("tr",{key:h,className:z%2===0?g.evenRow:void 0},e.createElement("td",null,e.createElement(Be.U,{isCollapsed:!s[h],onToggle:()=>d({...s,[h]:!V})})),e.createElement("td",null,h," ",M&&e.createElement(de.C0,null)),e.createElement("td",{className:g.actionsCell},M&&e.createElement(ae.A,{to:(0,ne.eQ)(`/alerting/notifications/templates/${encodeURIComponent(h)}/edit`,l),tooltip:"view template",icon:"file-alt"}),!M&&e.createElement(q.q,{actions:[P.oI.UpdateNotificationTemplate]},e.createElement(ae.A,{to:(0,ne.eQ)(`/alerting/notifications/templates/${encodeURIComponent(h)}/edit`,l),tooltip:"edit template",icon:"pen"})),e.createElement(q.q,{actions:[P.oI.CreateContactPoint]},e.createElement(ae.A,{to:(0,ne.eQ)(`/alerting/notifications/templates/${encodeURIComponent(h)}/duplicate`,l),tooltip:"Copy template",icon:"copy"})),!M&&e.createElement(q.q,{actions:[P.oI.DeleteNotificationTemplate]},e.createElement(ae.A,{onClick:()=>E(h),tooltip:"delete template",icon:"trash-alt"})))),V&&e.createElement("tr",{className:z%2===0?g.evenRow:void 0},e.createElement("td",null),e.createElement("td",{colSpan:2},e.createElement(We.C,{label:"Description",horizontal:!0},e.createElement(Ue.u,{width:"auto",height:"auto",autoHeight:!0,value:F,showLineNumbers:!1,monacoOptions:{readOnly:!0,scrollBeyondLastLine:!1}})))))}))),!!p&&e.createElement(Oe.s,{isOpen:!0,title:"Delete template",body:`Are you sure you want to delete template "${p}"?`,confirmText:"Yes, delete",onConfirm:B,onDismiss:()=>E(void 0)}))},$e=()=>{const{selectedAlertmanager:n}=(0,G.ZA)(),{data:l,error:r}=(0,Me.W)(n);return r?e.createElement(I.b,{title:"Failed to fetch notification templates"},String(r)):l?e.createElement(we,{config:l,alertManagerName:n}):null};var Ge=t(24789),ze=t(17302),Ve=t(85765),Qe=t(64516);const je=()=>{const n=(0,o.wW)(He),[l,r]=(0,J.j)(),s=l.get("search")??"",[d,g]=(0,e.useState)(s),[v,p]=(0,Ge.Z)(()=>{r({search:d},!0)},300,[r,d]),E=(0,e.useCallback)(()=>{p(),g(""),r({search:""},!0)},[p,r]),B=!!s;return e.createElement(ze.K,{direction:"row",alignItems:"end",gap:.5},e.createElement(Ve.g,{className:n.noBottom,label:"Search by name or type"},e.createElement(Qe.I,{"aria-label":"search contact points",placeholder:"Search",width:46,prefix:e.createElement(b.J,{name:"search"}),onChange:h=>{g(h.currentTarget.value)},value:d})),e.createElement(a.zx,{variant:"secondary",icon:"times",onClick:()=>E(),disabled:!B,"aria-label":"clear"},"Clear"))},He=()=>({noBottom:(0,u.css)({marginBottom:0})}),Ze=({alertManagerName:n})=>{const l=(0,ee.RY)(n);return e.createElement(q.q,{actions:[P.oI.UpdateExternalConfiguration]},e.createElement(I.b,{severity:"info",title:"Global config for contact points"},e.createElement("p",null,"For each external Alertmanager you can define global settings, like server addresses, usernames and password, for all the supported contact points."),e.createElement(a.Qj,{href:(0,ne.eQ)("alerting/notifications/global-config",n),variant:"secondary"},l?"View global config":"Edit global config")))};var se=t(5572);const Ye=(n,l)=>{const[r,s]=(0,e.useState)(!1),[d,g]=(0,e.useState)(),[v,p]=(0,e.useState)(),E=(0,e.useCallback)(()=>{l||(g(void 0),s(!1),p(void 0))},[l]),B=(0,e.useCallback)(M=>{g(M),s(!0),p(void 0)},[]),h=(0,e.useCallback)(()=>{d&&n(d).then(()=>s(!1)).catch(p)},[n,d]);return[(0,e.useMemo)(()=>v?e.createElement(Je,{isOpen:r,onDismiss:E,error:v}):e.createElement(se.u,{isOpen:r,onDismiss:E,closeOnBackdropClick:!l,closeOnEscape:!l,title:"Delete contact point"},e.createElement("p",null,"Deleting this contact point will permanently remove it."),e.createElement("p",null,"Are you sure you want to delete this contact point?"),e.createElement(se.u.ButtonRow,null,e.createElement(a.zx,{type:"button",variant:"destructive",onClick:h,disabled:l},l?"Deleting...":"Yes, delete contact point"),e.createElement(a.zx,{type:"button",variant:"secondary",onClick:E,disabled:l},"Cancel"))),[v,E,h,l,r]),B,E]},Je=({isOpen:n,onDismiss:l,error:r})=>e.createElement(se.u,{isOpen:n,onDismiss:l,closeOnBackdropClick:!0,closeOnEscape:!0,title:"Something went wrong"},e.createElement("p",null,"Failed to update your configuration:"),e.createElement("p",null,e.createElement("code",null,String(r))));var Xe=t(50248);const ke=()=>e.createElement(Xe.C,{text:"Unused","aria-label":"unused",color:"orange",icon:"exclamation-triangle",tooltip:"This contact point is not used in any notification policy and it will not receive any alerts"});var Z=t(23201),Ee=t(36755),qe=(n=>(n[n.ContactPoints=0]="ContactPoints",n[n.NotificationTemplates=1]="NotificationTemplates",n))(qe||{});const fe=10,_e=()=>{const{selectedAlertmanager:n}=(0,G.ZA)(),[l,r]=(0,e.useState)(0);let{isLoading:s,error:d,contactPoints:g}=(0,Z.ce)();const{deleteTrigger:v,updateAlertmanagerState:p}=(0,Z.kC)(n),[E,B]=(0,P.RA)(P.oI.CreateContactPoint),[h,F]=(0,P.RA)(P.oI.ExportContactPoint),[M,z]=Ye(v,p.isLoading),[V,_]=ye(),[k]=(0,J.j)(),{search:ce}=lt(k),Y=l===0,le=l===1;if(d)return e.createElement(I.b,{title:"Failed to fetch contact points"},d.message);const it=n===ee.GC;return e.createElement(e.Fragment,null,e.createElement(Se.u,{currentAlertmanager:n}),e.createElement(C.K,{direction:"column"},e.createElement(N.J,null,e.createElement(K.O,{label:"Contact Points",active:Y,counter:g.length,onChangeTab:()=>r(0)}),e.createElement(K.O,{label:"Notification Templates",active:le,onChangeTab:()=>r(1)})),e.createElement(Q.I,null,e.createElement(C.K,{direction:"column"},e.createElement(e.Fragment,null,s&&e.createElement(R.u,{text:"Loading..."}),Y&&e.createElement(e.Fragment,null,d?e.createElement(I.b,{title:"Failed to fetch contact points"},String(d)):e.createElement(e.Fragment,null,e.createElement(C.K,{direction:"row",alignItems:"end"},e.createElement(je,null),e.createElement(ie.L,null),e.createElement(C.K,{direction:"row",gap:1},E&&e.createElement(a.Qj,{icon:"plus","aria-label":"add contact point",variant:"primary",href:"/alerting/notifications/receivers/new",disabled:!B},"Add contact point"),h&&e.createElement(a.zx,{icon:"download-alt",variant:"secondary","aria-label":"export all",disabled:!F,onClick:()=>_(be)},"Export all"))),e.createElement(et,{contactPoints:g,search:ce,pageSize:fe,onDelete:st=>z(st),disabled:p.isLoading}),!it&&e.createElement(Ze,{alertManagerName:n}))),le&&e.createElement(e.Fragment,null,e.createElement(C.K,{direction:"row",alignItems:"center"},e.createElement(c.x,{variant:"body",color:"secondary"},"Create notification templates to customize your notifications."),e.createElement(ie.L,null),e.createElement(a.Qj,{icon:"plus",variant:"primary",href:"/alerting/notifications/templates/new"},"Add notification template")),e.createElement($e,null)))))),M,V)},et=({contactPoints:n,disabled:l=!1,search:r,pageSize:s=fe,onDelete:d})=>{const g=tt(n,r),{page:v,pageItems:p,numberOfPages:E,onPageChange:B}=(0,H.h)(g,1,s);return e.createElement(e.Fragment,null,p.map((h,F)=>{const M=(0,Ee.yL)(h),z=h.numberOfPolicies,V=`${h.name}-${F}`;return e.createElement(he,{key:V,name:h.name,disabled:l,onDelete:d,receivers:h.grafana_managed_receiver_configs,provisioned:M,policies:z})}),e.createElement(f.t,{currentPage:v,numberOfPages:E,onNavigate:B,hideWhenSinglePage:!0}))},ve=new L.Z({intraMode:1,intraIns:1,intraSub:1,intraDel:1,intraTrn:1});function tt(n,l){const r=(0,e.useMemo)(()=>n.map(p=>p.name),[n]),s=(0,e.useMemo)(()=>n.map(p=>p.grafana_managed_receiver_configs.map(E=>E[Z.qs].name).join(" ")),[n]);if(!l)return n;const d=ve.filter(r,l)??[],g=ve.filter(s,l)??[],v=[...d,...g];return(0,y.uniq)(v).map(p=>n[p])??[]}const he=({name:n,disabled:l=!1,provisioned:r=!1,receivers:s,policies:d=0,onDelete:g})=>{const v=(0,o.wW)(oe),p=s.some(E=>!!E[Z.zR]);return e.createElement("div",{className:v.contactPointWrapper,"data-testid":"contact-point"},e.createElement(C.K,{direction:"column",gap:0},e.createElement(nt,{name:n,policies:d,provisioned:r,disabled:l,onDelete:g}),p?e.createElement("div",null,s.map((E,B)=>{const h=E[Z.zR],F=E[Z.qs],M=!E.disableResolveMessage,z=E[Z.pY],V=F.name+B;return e.createElement(at,{key:V,name:F.name,type:E.type,description:(0,Ee.tS)(E),diagnostics:h,pluginMetadata:z,sendingResolved:M})})):e.createElement("div",{className:v.integrationWrapper},e.createElement(Ae,{receivers:s}))))},nt=n=>{const{name:l,disabled:r=!1,provisioned:s=!1,policies:d=0,onDelete:g}=n,v=(0,o.wW)(oe),[p,E]=(0,P.RA)(P.oI.ExportContactPoint),[B,h]=(0,P.RA)(P.oI.UpdateContactPoint),[F,M]=(0,P.RA)(P.oI.UpdateContactPoint),[z,V]=ye(),_=d>0,k=B&&h&&!s,ce=F&&M&&!s&&d===0,Y=[];return p&&Y.push(e.createElement(e.Fragment,{key:"export-contact-point"},e.createElement(m.v.Item,{icon:"download-alt",label:"Export",ariaLabel:"export",disabled:!E,"data-testid":"export",onClick:()=>V(l)}),e.createElement(m.v.Divider,null))),F&&Y.push(e.createElement(T.Z,{key:"delete-contact-point",shouldWrap:_,wrap:le=>e.createElement(i.u,{content:"Contact point is currently in use by one or more notification policies",placement:"top"},e.createElement("span",null,le))},e.createElement(m.v.Item,{label:"Delete",ariaLabel:"delete",icon:"trash-alt",destructive:!0,disabled:r||!ce,onClick:()=>g(l)}))),e.createElement("div",{className:v.headerWrapper},e.createElement(C.K,{direction:"row",alignItems:"center",gap:1},e.createElement(C.K,{alignItems:"center",gap:1},e.createElement(c.x,{variant:"body",weight:"medium"},l)),_&&e.createElement(X.g,null,e.createElement(W.Link,{to:(0,re.u)("/alerting/routes",{contactPoint:l})},"is used by ",e.createElement(te.c,null,d)," ",O()("notification policy",d))),s&&e.createElement(de.C0,null),!_&&e.createElement(ke,null),e.createElement(ie.L,null),e.createElement(a.Qj,{tooltipPlacement:"top",tooltip:s?"Provisioned contact points cannot be edited in the UI":void 0,variant:"secondary",size:"sm",icon:k?"pen":"eye",type:"button",disabled:r,"aria-label":`${k?"edit":"view"}-action`,"data-testid":`${k?"edit":"view"}-action`,href:`/alerting/notifications/receivers/${encodeURIComponent(l)}/edit`},k?"Edit":"View"),Y.length>0&&e.createElement(A.L,{overlay:e.createElement(m.v,null,Y)},e.createElement(Re.Z,null))),z)},at=n=>{const{name:l,type:r,description:s,diagnostics:d,pluginMetadata:g,sendingResolved:v=!0}=n,p=(0,o.wW)(oe),E=d!==void 0;return e.createElement("div",{className:p.integrationWrapper},e.createElement(C.K,{direction:"column",gap:.5},e.createElement(Ce,{name:l,type:r,description:s,pluginMetadata:g}),E&&e.createElement(ot,{diagnostics:d,sendingResolved:v})))};function Ce(n){const{name:l,type:r,description:s,pluginMetadata:d}=n,g=$.y[r];return e.createElement(C.K,{direction:"row",alignItems:"center",gap:1},e.createElement(C.K,{direction:"row",alignItems:"center",gap:.5},g&&e.createElement(b.J,{name:g}),d?e.createElement(xe,{metadata:d}):e.createElement(c.x,{variant:"body",color:"primary"},l)),s&&e.createElement(c.x,{variant:"bodySmall",color:"secondary"},s))}const Ae=({receivers:n})=>{const l=(0,y.groupBy)(n,r=>r.type);return e.createElement(C.K,{direction:"column",gap:0},e.createElement(C.K,{direction:"row",alignItems:"center",gap:1},Object.entries(l).map(([r,s],d)=>{const g=$.y[r],v=U[r]??(0,y.upperFirst)(r),p=(0,y.size)(l)-1===d;return e.createElement(e.Fragment,{key:r},e.createElement(C.K,{direction:"row",alignItems:"center",gap:.5},g&&e.createElement(b.J,{name:g}),e.createElement(c.x,{variant:"body"},v,s.length>1&&e.createElement(e.Fragment,null," (",s.length,")"))),!p&&"\u22C5")})))},ot=({diagnostics:n,sendingResolved:l})=>{const r=(0,o.wW)(oe),s=!!n.lastNotifyAttemptError,d=(0,w.CQ)(n.lastNotifyAttempt),g=n.lastNotifyAttemptDuration,v=d.isValid();return e.createElement("div",{className:r.metadataRow},e.createElement(C.K,{direction:"row",gap:1},s?e.createElement(e.Fragment,null,e.createElement(X.g,{color:"error",icon:"exclamation-circle"},e.createElement(i.u,{content:n.lastNotifyAttemptError},e.createElement("span",null,"Last delivery attempt failed")))):e.createElement(e.Fragment,null,v&&e.createElement(e.Fragment,null,e.createElement(X.g,{icon:"clock-nine"},"Last delivery attempt"," ",e.createElement(i.u,{content:d.toLocaleString()},e.createElement("span",null,e.createElement(te.c,null,d.locale("en").fromNow())))),e.createElement(X.g,{icon:"stopwatch"},"took ",e.createElement(te.c,null,g))),!v&&e.createElement(X.g,{icon:"clock-nine"},"No delivery attempts"),!l&&e.createElement(X.g,{icon:"info-circle"},"Delivering ",e.createElement(te.c,null,"only firing")," notifications"))))},be=Symbol("all contact points"),ye=()=>{const[n,l]=(0,e.useState)(null),[r,s]=(0,x.Z)(!1),[d,g]=(0,P.RA)(P.oI.DecryptSecrets),v=d&&g,p=(0,e.useCallback)(()=>{l(null),s(!1)},[s]),E=h=>{l(h),s(!0)};return[(0,e.useMemo)(()=>!n||!r?null:n===be?e.createElement(Le,{decrypt:v,onClose:p}):e.createElement(Te,{receiverName:n,decrypt:v,onClose:p}),[v,r,p,n]),E]},lt=n=>({search:n.get("search")??void 0}),oe=n=>({contactPointWrapper:(0,u.css)({borderRadius:`${n.shape.radius.default}`,border:`solid 1px ${n.colors.border.weak}`,borderBottom:"none"}),integrationWrapper:(0,u.css)({position:"relative",background:`${n.colors.background.primary}`,padding:`${n.spacing(1)} ${n.spacing(1.5)}`,borderBottom:`solid 1px ${n.colors.border.weak}`}),headerWrapper:(0,u.css)({background:`${n.colors.background.secondary}`,padding:`${n.spacing(1)} ${n.spacing(1.5)}`,borderBottom:`solid 1px ${n.colors.border.weak}`,borderTopLeftRadius:`${n.shape.radius.default}`,borderTopRightRadius:`${n.shape.radius.default}`}),metadataRow:(0,u.css)({borderBottomLeftRadius:`${n.shape.radius.default}`,borderBottomRightRadius:`${n.shape.radius.default}`})}),rt=_e},23201:(j,D,t)=>{t.d(D,{ce:()=>Q,kC:()=>R,pY:()=>N,qs:()=>C,zR:()=>I});var u=t(16826),L=t(69781),y=t.n(L),S=t(42460),O=t(56042),e=t(7119),W=t(1203),x=t(38251),w=t(36755);const I=Symbol("receiver_status"),C=Symbol("receiver_metadata"),N=Symbol("receiver_plugin_metadata"),K=10*1e3;function Q(){const{selectedAlertmanager:a,isGrafanaAlertmanager:c}=(0,W.ZA)(),{installed:f,loading:o}=(0,e.n)(x.W.OnCall),m=S.alertmanagerApi.endpoints.getContactPointsStatus.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,pollingInterval:K,skip:!c}),i=S.alertmanagerApi.endpoints.grafanaNotifiers.useQuery(void 0,{skip:!c}),{data:A,isLoading:b}=O.onCallApi.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!f||!c});let T;f?T=A??[]:f===!1&&(T=null);const U=S.alertmanagerApi.endpoints.getAlertmanagerConfiguration.useQuery(a,{refetchOnFocus:!0,refetchOnReconnect:!0,selectFromResult:G=>({...G,contactPoints:G.data?(0,w.Ml)(G.data,m.data,i.data,T):[]})}),P=U.error??m.error,H=U.isLoading||m.isLoading||o||b,J=U.contactPoints.sort((G,$)=>G.name.localeCompare($.name));return{error:P,isLoading:H,contactPoints:J}}function R(a){const[c]=S.alertmanagerApi.endpoints.getAlertmanagerConfiguration.useLazyQuery(),[f,o]=S.alertmanagerApi.endpoints.updateAlertmanagerConfiguration.useMutation();return{deleteTrigger:i=>c(a).then(({data:A})=>{if(!A)return;const b=(0,u.Uy)(A,T=>((0,L.remove)(T?.alertmanager_config?.receivers??[],U=>U.name===i),T));return f({selectedAlertmanager:a,config:b}).unwrap()}),updateAlertmanagerState:o}}},36755:(j,D,t)=>{t.d(D,{Ml:()=>a,tS:()=>Q,yL:()=>K});var u=t(69781),L=t(42420);function y(o){return"grafana_managed_receiver_configs"in o?o.grafana_managed_receiver_configs??[]:Object.entries(o).filter(([i])=>i!=="grafana_managed_receiver_configs"&&i.endsWith("_configs")).filter(([i,A])=>Array.isArray(A)&&!(0,u.isEmpty)(A)).reduce((i,[A,b])=>{const T=A.replace("_configs",""),U=(0,u.times)(b.length,()=>({name:o.name,type:T,settings:[],disableResolveMessage:!1}));return i.concat(U)},[])}var S=t(55395),O=t(38251),e=t(63638),W=t(50158);const I={title:"Grafana OnCall",icon:W.g[O.W.OnCall]};function C(o,m){if(o===void 0)return I;if(o==null)return{...I,warning:"Grafana OnCall is not installed or is disabled"};const i=o.find(A=>A.integration_url===m.settings.url);return{...I,description:i?.display_name,externalUrl:i?(0,e.d)(O.W.OnCall,`/integrations/${i.value}`):void 0,warning:i?void 0:"OnCall Integration no longer exists"}}var N=t(23201);function K(o){return!!o.grafana_managed_receiver_configs?.find(i=>i.provenance)?.provenance}function Q(o){switch(o.type){case"email":return"addresses"in o.settings?R(o.settings.addresses):void 0;case"slack":{const m=o.settings.recipient;return m?`#${m}`:void 0}case"kafka":return o.settings.kafkaTopic;case"webhook":return o.settings.url;case S.hM.OnCall:return o[N.pY]?.description;default:return o[N.qs]?.description}}function R(o){const i=/,|;|\n+/g,b=o.trim().split(i).map(u.trim).length-3,T=(0,u.split)(o,i,3);return b>0&&T.push(`+${b} more`),T.join(", ")}function a(o,m=[],i=[],A){const b=o.alertmanager_config.receivers??[],T=(0,L.tK)(o?.alertmanager_config?.route??{}),U=c(T),P=(0,u.countBy)(U);return b.map(H=>{const J=y(H),G=m.find($=>$.name===H.name);return{...H,numberOfPolicies:P[H.name]??0,grafana_managed_receiver_configs:J.map(($,ee)=>{const re=$.type===S.hM.OnCall;return{...$,[N.zR]:G?.integrations[ee],[N.qs]:f(i,$),[N.pY]:re?C(A,$):void 0}})}})}function c(o){const m=o.routes?.flatMap(i=>c(i))??[];return o.receiver?[o.receiver,...m]:m}function f(o,m){const i=o.find(A=>A.type===m.type);return{name:i?.name??(0,u.upperFirst)(m.type),description:i?.description}}},33143:(j,D,t)=>{t.d(D,{u:()=>R});var u=t(31733),L=t(73642),y=t(69781),S=t(75720);function O(a){const c=a.languages.CompletionItemKind.Function;return[{label:S.AlertmanagerTemplateFunction.toUpper,detail:"function(s string)",kind:c},{label:S.AlertmanagerTemplateFunction.toLower,detail:"function(s string)",kind:c},{label:S.AlertmanagerTemplateFunction.title,documentation:"Capitalizes the first letter of each word",detail:"function(s string)",kind:c},{label:S.AlertmanagerTemplateFunction.join,documentation:{value:"Joins an array of strings using the separator provided."},detail:"function(separator string, s []string)",kind:c},{label:S.AlertmanagerTemplateFunction.match,detail:"function",kind:c},{label:S.AlertmanagerTemplateFunction.safeHtml,detail:"function(pattern, repl, text)",kind:c},{label:S.AlertmanagerTemplateFunction.reReplaceAll,detail:"function(pattern, repl, text)",kind:c},{label:S.AlertmanagerTemplateFunction.stringSlice,detail:"function(s ...string)",kind:c}]}var e=t(13121);function W(a){const c={triggerCharacters:["."],provideCompletionItems(f,o,m){const i=f.getWordUntilPosition(o),A={startLineNumber:o.lineNumber,endLineNumber:o.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn},b=new w(a,A);if(!x(f,o))return b.getSnippetsSuggestions();if(m.triggerKind===a.languages.CompletionTriggerKind.Invoke&&!m.triggerCharacter)return b.getFunctionsSuggestions();const U=f.getWordUntilPosition({lineNumber:o.lineNumber,column:o.column-1});return b.getTemplateDataSuggestions(U.word)}};return a.languages.registerCompletionItemProvider("go-template",c)}function x(a,c){const f={startLineNumber:c.lineNumber,endLineNumber:c.lineNumber,startColumn:a.getLineMinColumn(c.lineNumber),endColumn:a.getLineMaxColumn(c.lineNumber)},o='\\{\\{[a-zA-Z0-9._() "]+\\}\\}';return a.findMatches(o,f,!0,!1,null,!0).some(i=>i.range.containsPosition(c))}class w{constructor(c,f){this.monaco=c,this.range=f,this.getSnippetsSuggestions=()=>this.getCompletionsFromDefinitions((0,e.Zn)(this.monaco)),this.getFunctionsSuggestions=()=>this.getCompletionsFromDefinitions(O(this.monaco)),this.getTemplateDataSuggestions=o=>{switch(o){case"":return this.getCompletionsFromDefinitions((0,e.y5)(this.monaco),(0,e.J_)(this.monaco));case"Alerts":return this.getCompletionsFromDefinitions((0,e.WA)(this.monaco));case"GroupLabels":case"CommonLabels":case"CommonAnnotations":case"Labels":case"Annotations":return this.getCompletionsFromDefinitions((0,e.wY)(this.monaco));default:return{suggestions:[]}}},this.getCompletionsFromDefinitions=(...o)=>({suggestions:(0,y.concat)(...o).map(i=>I(i,this.range))})}}function I({label:a,detail:c,documentation:f,kind:o,insertText:m},i){const A=typeof a=="string"?a:a.label,b=typeof a=="string"?{label:a,description:c}:{...a};return b.description??=c,{label:b,kind:o,insertText:m??A,range:i,documentation:f,detail:c}}const C="go-template",K={id:C,extensions:[],aliases:[],mimetypes:[],loader:()=>Promise.resolve().then(t.bind(t,75720))},Q=(a,c)=>{const{id:f,loader:o}=c;a.languages.getLanguages().find(i=>i.id===f)||(a.languages.register({id:f}),o().then(i=>{a.languages.setMonarchTokensProvider(f,i.language),a.languages.setLanguageConfiguration(f,i.conf)}))},R=a=>{const c=!!a.autoHeight,f=(0,u.useRef)(null),o=m=>{if(c){const i=m.getContentHeight();try{m.layout({height:i,width:NaN})}catch{}}};return(0,u.useEffect)(()=>()=>{f.current?.dispose()},[]),u.createElement(L.p,{showLineNumbers:!0,showMiniMap:!1,...a,onEditorDidMount:o,onBeforeEditorMount:m=>{Q(m,K),f.current=W(m)},language:C})}},13121:(j,D,t)=>{t.d(D,{J_:()=>I,WA:()=>C,y5:()=>w,wY:()=>N,Zn:()=>Q,hn:()=>K});const u=`
{{ range .Alerts }}
  Status: {{ .Status }}
  Starts at: {{ .StartsAt }}
{{ end }}
`,L=`
[{{.Status}}] {{ .Labels.alertname }}

Labels:
{{ range .Labels.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}

{{ if gt (len .Annotations) 0 }}
Annotations:
{{ range .Annotations.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}
{{ end }}

{{ if gt (len .SilenceURL ) 0 }}
  Silence alert: {{ .SilenceURL }}
{{ end }}
{{ if gt (len .DashboardURL ) 0 }}
  Go to dashboard: {{ .DashboardURL }}
{{ end }}
`,y=x("GroupLabels.SortedPairs"),S=x("CommonLabels.SortedPairs"),O=x("CommonAnnotations.SortedPairs"),e=x("Labels.SortedPairs"),W=x("Annotations.SortedPairs");function x(R){return`
{{ range .${R} }}
  {{ .Name }} = {{ .Value }}
{{ end }}`}function w(R){const a=R.languages.CompletionItemKind.Field;return[{label:"Alerts",kind:a,detail:"Alert[]",documentation:{value:"An Array containing all alerts"}},{label:"Receiver",kind:a,detail:"string"},{label:"Status",kind:a,detail:"string"},{label:"GroupLabels",kind:a,detail:"[]KeyValue"},{label:"CommonLabels",kind:a,detail:"[]KeyValue"},{label:"CommonAnnotations",kind:a,detail:"[]KeyValue"},{label:"ExternalURL",kind:a,detail:"string"}]}function I(R){const a=R.languages.CompletionItemKind.Field;return[{label:{label:"Status",detail:"(Alert)",description:"string"},kind:a,detail:"string",documentation:{value:"Status of the alert. It can be `firing` or `resolved`"}},{label:{label:"Labels",detail:"(Alert)"},kind:a,detail:"[]KeyValue",documentation:{value:"A set of labels attached to the alert."}},{label:{label:"Annotations",detail:"(Alert)"},kind:a,detail:"[]KeyValue",documentation:"A set of annotations attached to the alert."},{label:{label:"StartsAt",detail:"(Alert)"},kind:a,detail:"time.Time",documentation:"Time the alert started firing."},{label:{label:"EndsAt",detail:"(Alert)"},kind:a,detail:"time.Time",documentation:"Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received."},{label:{label:"GeneratorURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Back link to Grafana or external Alertmanager."},{label:{label:"SilenceURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts."},{label:{label:"DashboardURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"PanelURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"Fingerprint",detail:"(Alert)"},kind:a,detail:"string",documentation:"Fingerprint that can be used to identify the alert."},{label:{label:"ValueString",detail:"(Alert)"},kind:a,detail:"string",documentation:"String that contains labels and values of each reduced expression in the alert."}]}function C(R){const a=R.languages.CompletionItemKind.Field;return[{label:"Firing",kind:a,detail:"Alert[]"},{label:"Resolved",kind:a,detail:"Alert[]"}]}function N(R){const a=R.languages.CompletionItemKind.Field;return[{label:"SortedPairs",kind:a,detail:"[]KeyValue"},{label:"Names",kind:a,detail:"[]string"},{label:"Values",kind:a,detail:"[]string"},{label:"Remove",detail:"KeyValue[] function(keys []string)",kind:R.languages.CompletionItemKind.Method}]}const K={alerts:{label:"alertsloop",description:"Renders a loop through alerts",snippet:u},alertDetails:{label:"alertdetails",description:"Renders all information available about the alert",snippet:L},groupLabels:{label:"grouplabelsloop",description:"Renders a loop through group labels",snippet:y},commonLabels:{label:"commonlabelsloop",description:"Renders a loop through common labels",snippet:S},commonAnnotations:{label:"commonannotationsloop",description:"Renders a loop through common annotations",snippet:O},labels:{label:"labelsloop",description:"Renders a loop through labels",snippet:e},annotations:{label:"annotationsloop",description:"Renders a loop through annotations",snippet:W}};function Q(R){const a=R.languages.CompletionItemKind.Snippet,c=R.languages.CompletionItemInsertTextRule.InsertAsSnippet,{alerts:f,alertDetails:o,groupLabels:m,commonLabels:i,commonAnnotations:A,labels:b,annotations:T}=K;return[{label:f.label,documentation:f.description,kind:a,insertText:f.snippet,insertTextRules:c},{label:{label:o.label,detail:"(Alert)"},documentation:o.description,kind:a,insertText:o.snippet,insertTextRules:c},{label:m.label,documentation:m.description,kind:a,insertText:m.snippet,insertTextRules:c},{label:i.label,documentation:i.description,kind:a,insertText:i.snippet,insertTextRules:c},{label:A.label,documentation:A.description,kind:a,insertText:A.snippet,insertTextRules:c},{label:{label:b.label,detail:"(Alert)"},documentation:b.description,kind:a,insertText:b.snippet,insertTextRules:c},{label:{label:T.label,detail:"(Alert)"},documentation:T.description,kind:a,insertText:T.snippet,insertTextRules:c}]}},50158:(j,D,t)=>{t.d(D,{g:()=>L});var u=t(38251);const L={[u.W.OnCall]:"public/img/alerting/oncall_logo.svg",[u.W.Incident]:"",[u.W.MachineLearning]:""}},74086:(j,D,t)=>{t.d(D,{A:()=>S});var u=t(31733),L=t(58037),y=t(51343);const S=({tooltip:O,icon:e,to:W,target:x,onClick:w,className:I,tooltipPlacement:C="top",...N})=>{const K=typeof O=="string"?O:void 0;return u.createElement(L.u,{content:O,placement:C},W?u.createElement(y.Qj,{variant:"secondary",fill:"text",icon:e,href:W,size:"sm",target:x,...N,"aria-label":K}):u.createElement(y.zx,{className:I,variant:"secondary",fill:"text",size:"sm",icon:e,type:"button",onClick:w,...N,"aria-label":K}))}},37365:(j,D,t)=>{t.d(D,{D:()=>L});var u=t(76932);const L=y=>({table:(0,u.css)`
    width: 100%;
    border-radius: ${y.shape.radius.default};
    border: solid 1px ${y.colors.border.weak};
    background-color: ${y.colors.background.secondary};

    th {
      padding: ${y.spacing(1)};
    }

    td {
      padding: 0 ${y.spacing(1)};
    }

    tr {
      height: 38px;
    }
  `,evenRow:(0,u.css)`
    background-color: ${y.colors.background.primary};
  `,colExpand:(0,u.css)`
    width: 36px;
  `,nameCell:(0,u.css)`
    gap: ${y.spacing(1)};
  `,actionsCell:(0,u.css)`
    text-align: right;
    width: 1%;
    white-space: nowrap;

    & > * + * {
      margin-left: ${y.spacing(.5)};
    }
  `})}}]);

//# sourceMappingURL=4759.0221502cca8caeeb0a09.js.map