"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[937],{21458:(q,F,e)=>{e.d(F,{N:()=>V});var D=e(68235),t=e(31414),A=e(18198),L=e(85666),C=e(27957),Q=e(85610),U=e(74779);const N="hideSeriesFrom",G=(0,D.Y4)(N);function V(f,l,i,p){const{overrides:g}=i,d=f,h=g.findIndex(G);if(h<0){if(l===U.R.ToggleSelection){const n=x([d,...K(g,p)]);return{...i,overrides:[...i.overrides,n]}}const S=B(p,d),T=x(S);return{...i,overrides:[...i.overrides,T]}}const E=Array.from(g),[s]=E.splice(h,1);if(l===U.R.ToggleSelection){let S=I(s);const T=K(E,p);if(T.length>0&&(S=S.filter(r=>T.indexOf(r)<0)),S[0]===d&&S.length===1)return{...i,overrides:E};const n=x([d,...T]);return{...i,overrides:[...E,n]}}const M=v(s,d);return X(M,p)?{...i,overrides:E}:{...i,overrides:[...E,M]}}function x(f,l=t.Ys.exclude,i){return i=i??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:N,matcher:{id:A.mi.byNames,options:{mode:l,names:f,prefix:l===t.Ys.exclude?"All except:":void 0,readOnly:!0}},properties:[{...i,value:{viz:!0,legend:!1,tooltip:!1}}]}}const v=(f,l,i=t.Ys.exclude)=>{const p=f.properties.find(h=>h.id==="custom.hideFrom"),g=I(f),d=g.findIndex(h=>h===l);return d<0?g.push(l):g.splice(d,1),x(g,i,p)},I=f=>{const l=f.matcher.options?.names;return Array.isArray(l)?[...l]:[]},X=(f,l)=>I(f).length===B(l).length,B=(f,l)=>{const i=new Set;for(const p of f)for(const g of p.fields){if(g.type!==L.fS.number)continue;const d=(0,C.CZ)(g,p,f);d!==l&&i.add(d)}return Array.from(i)},K=(f,l)=>{let i=[];for(const p of f){const g=p.properties.find(d=>d.id==="custom.hideFrom");if(g!==void 0&&g.value?.legend===!0){const h=Q.Ls.get(p.matcher.id).get(p.matcher.options);for(const E of l)for(const s of E.fields){if(s.type!==L.fS.number)continue;const M=(0,C.CZ)(s,E,l);h(s,E,l)&&i.push(M)}}}return i}},12807:(q,F,e)=>{e.d(F,{y:()=>T});var D=e(69781),t=e(31733),A=e(31621),L=e(20298),C=e(74011),Q=e(14103),U=e(91507),N=e(19596),G=e(27957),V=e(42692),x=e(31524),v=e(71199),I=e(76067),X=e(43348),B=e(33926),K=e(21458),f=e(9985),l=e(16826);function i(n,r,c){return(0,l.Uy)(n,o=>{o.defaults.custom===void 0&&(o.defaults.custom={}),o.defaults.max=c;const{custom:a}=o.defaults;switch(a.stacking===void 0&&(a.stacking={group:"A"}),r){case"lines":a.drawStyle=v.l8.Line,a.stacking.mode=v.o0.None,a.fillOpacity=0;break;case"bars":a.drawStyle=v.l8.Bars,a.stacking.mode=v.o0.None,a.fillOpacity=100;break;case"points":a.drawStyle=v.l8.Points,a.stacking.mode=v.o0.None,a.fillOpacity=0;break;case"stacked_lines":a.drawStyle=v.l8.Line,a.stacking.mode=v.o0.Normal,a.fillOpacity=100,a.axisSoftMin=0;break;case"stacked_bars":a.drawStyle=v.l8.Bars,a.stacking.mode=v.o0.Normal,a.fillOpacity=100,a.axisSoftMin=0;break;default:{const O=r;throw new Error(`Invalid graph-style: ${O}`)}}})}function p(n,r,c){return(0,l.Uy)(n,o=>{o.defaults.thresholds=c,o.defaults.custom=o.defaults.custom??{},o.defaults.custom.thresholdsStyle=r})}var g=function(n){return(n+1)%1e6};function d(){var n=(0,t.useReducer)(g,0),r=n[1];return r}function h(n,r){return typeof n=="function"?n.length?n(r):n():n}function E(n){var r=(0,t.useRef)(h(n)),c=d();return(0,t.useMemo)(function(){return[function(){return r.current},function(o){r.current=h(o,r.current),c()}]},[])}function s(n,r,c){n===void 0&&(n=0),r===void 0&&(r=null),c===void 0&&(c=null);var o=h(n);typeof o!="number"&&console.error("initialValue has to be a number, got "+typeof n),typeof c=="number"?o=Math.max(o,c):c!==null&&console.error("min has to be a number, got "+typeof c),typeof r=="number"?o=Math.min(o,r):r!==null&&console.error("max has to be a number, got "+typeof r);var a=E(o),O=a[0],W=a[1];return[O(),(0,t.useMemo)(function(){var P=function(m){var u=O(),y=h(m,u);u!==y&&(typeof c=="number"&&(y=Math.max(y,c)),typeof r=="number"&&(y=Math.min(y,r)),u!==y&&W(y))};return{get:O,set:P,inc:function(m){m===void 0&&(m=1);var u=h(m,O());typeof u!="number"&&console.error("delta has to be a number or function returning a number, got "+typeof u),P(function(y){return y+u})},dec:function(m){m===void 0&&(m=1);var u=h(m,O());typeof u!="number"&&console.error("delta has to be a number or function returning a number, got "+typeof u),P(function(y){return y-u})},reset:function(m){m===void 0&&(m=o);var u=h(m,O());typeof u!="number"&&console.error("value has to be a number or function returning a number, got "+typeof u),o=u,P(u)}}},[o,c,r])]}var M=e(82401);function S(n){const[r,{inc:c}]=s(1),o=(0,A.Z)(n);return(0,t.useMemo)(()=>{o&&!(0,M.nl)(n,o,M.Ch)&&c()},[n,o,c]),r}function T({data:n,height:r,width:c,timeZone:o,absoluteRange:a,onChangeTime:O,loadingState:W,annotations:P,onHiddenSeriesChanged:m,splitOpenFn:u,graphStyle:y,tooltipDisplayMode:j=v.f3.Single,anchorToZero:_=!1,yAxisMaximum:z,thresholdsConfig:$,thresholdsStyle:J,eventBus:Y}){const b=(0,I.l4)(),te=(0,A.Z)(a),H=W===L.Gu.Loading&&te?te:a,ne=(0,t.useMemo)(()=>({from:(0,C.CQ)(H.from),to:(0,C.CQ)(H.to),raw:{from:(0,C.CQ)(H.from),to:(0,C.CQ)(H.to)}}),[H.from,H.to]),oe=(0,t.useMemo)(()=>(0,Q.j)((0,B.F)(B.r),"Explore"),[]),[ee,se]=(0,t.useState)({defaults:{min:_?0:void 0,max:z||void 0,unit:"short",color:{mode:U.S.PaletteClassic},custom:{drawStyle:v.l8.Line,fillOpacity:0,pointSize:5}},overrides:[]}),re=(0,t.useMemo)(()=>{const R=i(ee,y,z);return p(R,J,$)},[ee,y,z,$,J]),Z=(0,f.v)(u,ne),w=(0,t.useMemo)(()=>(0,N.SM)({fieldConfig:re,data:n,timeZone:o,replaceVariables:R=>R,theme:b,fieldConfigRegistry:oe,dataLinkPostProcessor:Z}),[oe,n,o,b,re,Z]),ae=(0,t.useMemo)(()=>(0,N.SM)({fieldConfig:{defaults:{},overrides:[]},data:P,timeZone:o,replaceVariables:R=>R,theme:b,dataLinkPostProcessor:Z}),[P,o,b,Z]),ie=S(w);(0,t.useEffect)(()=>{if(m){const R=[];w.forEach(k=>{k.fields.map(ue=>ue.config?.custom?.hideFrom?.viz).every(D.identity)&&R.push((0,G.nf)(k))}),m(R)}},[w,m]);const le={eventsScope:"explore",eventBus:Y,sync:()=>V.m.Crosshair,onToggleSeriesVisibility(R,k){se((0,K.N)(R,k,ee,n))},dataLinkPostProcessor:Z},ce=(0,t.useMemo)(()=>({tooltip:{mode:j,sort:v.As.None},legend:{displayMode:v.jK.List,showLegend:!0,placement:"bottom",calcs:[]}}),[j]);return t.createElement(X._w,{value:le},t.createElement(x.$,{data:{series:w,timeRange:ne,state:W,annotations:ae,structureRev:ie},pluginId:"timeseries",title:"",width:c,height:r,onChangeTimeRange:O,timeZone:o,options:ce}))}},10937:(q,F,e)=>{e.d(F,{F:()=>h});var D=e(76932),t=e(31733),A=e(83870),L=e(76067),C=e(48011),Q=e(49311),U=e(58037),N=e(51343),G=e(53166),V=e(72965),x=e(12807),v=e(96856),I=e(42342);const X=I.EXPLORE_GRAPH_STYLES.map(s=>({value:s,label:s[0].toUpperCase()+s.slice(1).replace(/_/," ")}));function B(s){const{graphStyle:M,onChangeGraphStyle:S}=s;return t.createElement(v.S,{size:"sm",options:X,value:M,onChange:S})}var K=e(39357);const f="grafana.explore.style.graph",l=s=>{store.set(f,s)},i=()=>g(K.Z.get(f)),p="lines",g=s=>I.EXPLORE_GRAPH_STYLES.find(S=>S===s)??p,d=20,h=({data:s,eventBus:M,height:S,width:T,absoluteRange:n,timeZone:r,annotations:c,onChangeTime:o,splitOpenFn:a,thresholdsConfig:O,thresholdsStyle:W,loadingState:P,statusMessage:m})=>{const[u,y]=(0,A.Z)(!1),[j,_]=(0,t.useState)(i),z=(0,L.wW)(E),$=(0,t.useCallback)(Y=>{(0,V.FG)(Y),_(Y)},[]),J=(0,t.useMemo)(()=>u?s:s.slice(0,d),[s,u]);return t.createElement(C.fm,{title:(0,G.t)("graph.container.title","Graph"),titleItems:[!u&&d<s.length&&t.createElement("div",{key:"disclaimer",className:z.timeSeriesDisclaimer},t.createElement("span",{className:z.warningMessage},t.createElement(Q.J,{name:"exclamation-triangle","aria-hidden":"true"}),t.createElement(G.cC,{i18nKey:"graph.container.show-only-series"},"Showing only ",{MAX_NUMBER_OF_TIME_SERIES:d}," series")),t.createElement(U.u,{content:(0,G.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},t.createElement(N.zx,{variant:"secondary",size:"sm",onClick:y},t.createElement(G.cC,{i18nKey:"graph.container.show-all-series"},"Show all ",{length:s.length}))))].filter(Boolean),width:T,height:S,loadingState:P,statusMessage:m,actions:t.createElement(B,{graphStyle:j,onChangeGraphStyle:$})},(Y,b)=>t.createElement(x.y,{graphStyle:j,data:J,height:b,width:Y,absoluteRange:n,onChangeTime:o,timeZone:r,annotations:c,splitOpenFn:a,loadingState:P,thresholdsConfig:O,thresholdsStyle:W,eventBus:M}))},E=s=>({timeSeriesDisclaimer:(0,D.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:s.spacing(1)}),warningMessage:(0,D.css)({display:"flex",alignItems:"center",gap:s.spacing(.5),color:s.colors.warning.main,fontSize:s.typography.bodySmall.fontSize})})},9985:(q,F,e)=>{e.d(F,{v:()=>A});var D=e(31733),t=e(97402);const A=(L,C)=>(0,D.useMemo)(()=>(0,t.qQ)(L,C),[L,C])}}]);

//# sourceMappingURL=937.47bdd617ac1463afcfff.js.map