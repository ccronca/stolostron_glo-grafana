"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9207],{19207:(A,P,_)=>{_.d(P,{IT:()=>B,O6:()=>D,PP:()=>y,Ql:()=>j,Z3:()=>J,ZO:()=>K,f0:()=>v,i1:()=>q,qV:()=>U,we:()=>M,xu:()=>w,zj:()=>S});var d=_(69781),R=_.n(d),h=_(86504),$=_.n(h),m=_(47118),t=_(69328),C=_(74823),o=_(9184);function M(e,r){const n=[V()],a=["$__auto"];let s;return e===o.B5.QuantileOverTime&&(a.push("0.95"),n.push({name:"Quantile",type:"number"})),r&&(n.push({name:"By label",type:"string",restParam:!0,optional:!0}),s=x(`__${e}_by`)),{id:e,name:f(e),params:n,defaultParams:a,alternativesKey:"range function",category:o.Ly.RangeFunctions,orderRank:o.jK.RangeVectorFunction,renderer:H,addOperationHandler:v,paramChangedHandler:s,explainHandler:(i,u)=>{let l=C.r8.find(c=>c.insertText===i.id)?.documentation??"";return i.params[0]==="$__auto"?`${l} \`$__auto\` is a variable that will be replaced with the [value of step](https://grafana.com/docs/grafana/next/datasources/loki/query-editor/#options) for range queries and with the value of the selected time range (calculated to - from) for instant queries.`:`${l} The [range vector](https://grafana.com/docs/loki/latest/logql/metric_queries/#range-vector-aggregation) is set to \`${i.params[0]}\`.`}}}function D(e){const r=M(e,!0),n=r.params.slice(0,-1);return[r,{id:`__${e}_by`,name:`${f(e)} by`,params:[...n,{name:"Label",type:"string",restParam:!0,optional:!0,editor:m.g}],defaultParams:[...r.defaultParams,""],alternativesKey:"range function with grouping",category:o.Ly.RangeFunctions,renderer:F(e,"by"),paramChangedHandler:b(e),explainHandler:p(e,"by"),addOperationHandler:v,hideFromList:!0},{id:`__${e}_without`,name:`${f(e)} without`,params:[...n,{name:"Label",type:"string",restParam:!0,optional:!0,editor:m.g}],defaultParams:[...r.defaultParams,""],alternativesKey:"range function with grouping",category:o.Ly.RangeFunctions,renderer:F(e,"without"),paramChangedHandler:b(e),explainHandler:p(e,"without"),addOperationHandler:v,hideFromList:!0}]}function F(e,r){return function(a,s,i){const u=s.params.findIndex(g=>g.restParam),l=a.params.slice(0,u),c=a.params.slice(u);return l.length===2&&e===o.B5.QuantileOverTime?`${e}(${l[1]}, ${i} [${l[0]}]) ${r} (${c.join(", ")})`:`${e}(${i} [${l[0]}]) ${r} (${c.join(", ")})`}}function H(e,r,n){const a=e.params??[],s=a[0]??"$__auto";if(a.length===2&&e.id===o.B5.QuantileOverTime){const i=a[1];return`${e.id}(${i}, ${n} [${s}])`}return`${e.id}(${n} [${a[0]??"$__auto"}])`}function w(e,r,n){return["<","<=",">",">="].includes(String(e.params[1]))?`${n} | ${e.params[0]} ${e.params[1]} ${e.params[2]}`:`${n} | ${e.params[0]} ${e.params[1]} \`${e.params[2]}\``}function K(e,r){const n=e.params[1].toString().startsWith("!");return r.filter(i=>i.id===o.B5.LabelFilter&&i.params[0]===e.params[0]&&i.params[2]===e.params[2]).some(i=>!!(n&&i.params[1].toString().startsWith("!")===!1||n===!1&&i.params[1].toString().startsWith("!")))}function j(e,r,n){switch(e.id){case o.B5.Logfmt:const[a=!1,s=!1,...i]=e.params;return`${n} | logfmt${a?" --strict":""}${s?" --keep-empty":""} ${i.filter(u=>u).join(", ")}`.trim();case o.B5.Json:return`${n} | json ${e.params.filter(u=>u).join(", ")}`.trim();case o.B5.Drop:return`${n} | drop ${e.params.filter(u=>u).join(", ")}`.trim();case o.B5.Keep:return`${n} | keep ${e.params.filter(u=>u).join(", ")}`.trim();default:return`${n} | ${e.id}`}}function W(e){return e.category===o.Ly.RangeFunctions}function T(e,r,n){const a=e.findIndex(s=>{const i=r.getOperationDef(s.id);return i?n(i):!1});return a===-1?e.length:a}function v(e,r,n){const a={id:e.id,params:e.defaultParams},s=[...r.operations],i=s.find(u=>{const l=n.getOperationDef(u.id);return l?W(l):!1});switch(e.category){case o.Ly.Aggregations:case o.Ly.Functions:if(!i){const l=T(s,n,c=>c.category===o.Ly.Functions);s.splice(l,0,{id:o.B5.Rate,params:["$__auto"]})}s.push(a);break;case o.Ly.RangeFunctions:if(i){const l=s.indexOf(i);s[l]=a;break}default:const u=T(s,n,l=>(e.orderRank??100)<(l.orderRank??100));s.splice(u,0,a);break}return{...r,operations:s}}function U(e,r){return{...r,binaryQueries:[...r.binaryQueries??[],{operator:"/",query:r}]}}function S(e,r){return function(a,s,i){const u=a.params.some(g=>typeof g=="string"&&g.includes("`")),l=u?'"':"`";let c;return u?c=a.params.map(g=>typeof g=="string"?(0,t.U9)(g):g):c=a.params,r?`${i} ${e} ${l}(?i)${c.join(`${l} or ${l}(?i)`)}${l}`:`${i} ${e} ${l}${c.join(`${l} or ${l}`)}${l}`}}function V(){return{name:"Range",type:"string",options:["$__auto","1m","5m","10m","1h","24h"]}}function q(e,r){return`operations.${e}.param.${r}`}function x(e){return function(n,a,s){return a.params.length===s.params.length?{...a,id:e}:a}}function p(e,r){return function(a){const s=a.params.map(u=>`\`${u}\``).join(" and "),i=$()("label",a.params.length);switch(r){case"by":return`Calculates ${e} over dimensions while preserving ${i} ${s}.`;case"without":return`Calculates ${e} over the dimensions ${s}. All other labels are preserved.`;default:return`Calculates ${e} over the dimensions.`}}}function b(e){return function(n,a,s){return a.params.length<s.params.length?{...a,id:e}:a}}function f(e){return(0,d.capitalize)(e.replace(/_/g," "))}function y(e,r){const n={id:e.id,params:e.defaultParams};return{...r,operations:[...r.operations,n]}}function B(e,r={}){return[{id:e,name:f(e),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:o.Ly.Aggregations,renderer:z,paramChangedHandler:x(`__${e}_by`),explainHandler:p(e,""),addOperationHandler:y,...r},{id:`__${e}_by`,name:`${f(e)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:m.g}],defaultParams:[""],alternativesKey:"aggregations by",category:o.Ly.Aggregations,renderer:Q(e),paramChangedHandler:b(e),explainHandler:p(e,"by"),addOperationHandler:y,hideFromList:!0,...r},{id:`__${e}_without`,name:`${f(e)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:m.g}],defaultParams:[""],alternativesKey:"aggregations by",category:o.Ly.Aggregations,renderer:N(e),paramChangedHandler:b(e),explainHandler:p(e,"without"),addOperationHandler:y,hideFromList:!0,...r}]}function N(e){return function(n,a,s){return`${e} without(${n.params.join(", ")}) (${s})`}}function z(e,r,n){const a=G(e,r,n),s=e.id+"(";return n&&a.push(n),s+a.join(", ")+")"}function G(e,r,n){return(e.params??[]).map((a,s)=>r.params[s].type==="string"?'"'+a+'"':a)}function Q(e){return function(n,a,s){return`${e} by(${n.params.join(", ")}) (${s})`}}function J(e,r,n={}){const a=B(e,n);return a[0].params.unshift(...r.params),a[1].params.unshift(...r.params),a[2].params.unshift(...r.params),a[0].defaultParams=r.defaultParams,a[1].defaultParams=[...r.defaultParams,""],a[2].defaultParams=[...r.defaultParams,""],a[1].renderer=E(e),a[2].renderer=E(e),a}function E(e){return function(n,a,s){const i=a.params.findIndex(c=>c.restParam),u=n.params.slice(0,i),l=n.params.slice(i);return`${e} by(${l.join(", ")}) (${u.map((c,g)=>a.params[g].type==="string"?`"${c}"`:c).join(", ")}, ${s})`}}},9184:(A,P,_)=>{_.d(P,{AI:()=>m,B5:()=>h,Hv:()=>d,Ly:()=>R,jK:()=>$});var d=(t=>(t.Log="log",t.Metric="metric",t))(d||{}),R=(t=>(t.Aggregations="Aggregations",t.RangeFunctions="Range functions",t.Functions="Functions",t.Formats="Formats",t.LineFilters="Line filters",t.LabelFilters="Label filters",t.BinaryOps="Binary operations",t))(R||{}),h=(t=>(t.Json="json",t.Logfmt="logfmt",t.Regexp="regexp",t.Pattern="pattern",t.Unpack="unpack",t.LineFormat="line_format",t.LabelFormat="label_format",t.Decolorize="decolorize",t.Drop="drop",t.Keep="keep",t.Rate="rate",t.RateCounter="rate_counter",t.CountOverTime="count_over_time",t.SumOverTime="sum_over_time",t.AvgOverTime="avg_over_time",t.MaxOverTime="max_over_time",t.MinOverTime="min_over_time",t.FirstOverTime="first_over_time",t.LastOverTime="last_over_time",t.StdvarOverTime="stdvar_over_time",t.StddevOverTime="stddev_over_time",t.QuantileOverTime="quantile_over_time",t.BytesRate="bytes_rate",t.BytesOverTime="bytes_over_time",t.AbsentOverTime="absent_over_time",t.Sum="sum",t.Avg="avg",t.Min="min",t.Max="max",t.Stddev="stddev",t.Stdvar="stdvar",t.Count="count",t.TopK="topk",t.BottomK="bottomk",t.LineContains="__line_contains",t.LineContainsNot="__line_contains_not",t.LineContainsCaseInsensitive="__line_contains_case_insensitive",t.LineContainsNotCaseInsensitive="__line_contains_not_case_insensitive",t.LineMatchesRegex="__line_matches_regex",t.LineMatchesRegexNot="__line_matches_regex_not",t.LineFilterIpMatches="__line_filter_ip_matches",t.LabelFilter="__label_filter",t.LabelFilterNoErrors="__label_filter_no_errors",t.LabelFilterIpMatches="__label_filter_ip_marches",t.Unwrap="unwrap",t.SumBy="__sum_by",t.SumWithout="__sum_without",t.Addition="__addition",t.Subtraction="__subtraction",t.MultiplyBy="__multiply_by",t.DivideBy="__divide_by",t.Modulo="__modulo",t.Exponent="__exponent",t.NestedQuery="__nested_query",t.EqualTo="__equal_to",t.NotEqualTo="__not_equal_to",t.GreaterThan="__greater_than",t.LessThan="__less_than",t.GreaterOrEqual="__greater_or_equal",t.LessOrEqual="__less_or_equal",t))(h||{}),$=(t=>(t[t.LineFilters=1]="LineFilters",t[t.Parsers=2]="Parsers",t[t.PipeOperations=3]="PipeOperations",t[t.Unwrap=4]="Unwrap",t[t.NoErrors=5]="NoErrors",t[t.RangeVectorFunction=5]="RangeVectorFunction",t[t.Last=6]="Last",t))($||{});const m={equals:{label:"=",value:"=",description:"Equals",isMultiValue:!1},doesNotEqual:{label:"!=",value:"!=",description:"Does not equal",isMultiValue:!1},matchesRegex:{label:"=~",value:"=~",description:"Matches regex",isMultiValue:!0},doesNotMatchRegex:{label:"!~",value:"!~",description:"Does not match regex",isMultiValue:!0},greaterThan:{label:">",value:">",description:"Greater than",isMultiValue:!1},greaterThanOrEqual:{label:">=",value:">=",description:"Greater than or equal to",isMultiValue:!1},lessThan:{label:"<",value:"<",description:"Less than",isMultiValue:!1},lessThanOrEqual:{label:"<=",value:"<=",description:"Less than or equal to",isMultiValue:!1},contains:{label:"|=",value:"|=",description:"Contains",isMultiValue:!1},doesNotContain:{label:"!=",value:"!=",description:"Does not contain",isMultiValue:!1}}}}]);

//# sourceMappingURL=9207.6a5552e5f5bd5b7d248f.js.map