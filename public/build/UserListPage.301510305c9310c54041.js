"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7497,8039],{14124:(Pe,x,n)=>{n.r(x),n.d(x,{default:()=>Ne});var a=n(76932),e=n(31733),L=n(21568),D=n(85498),y=n(28298),u=n(4981),T=n(76067),z=n(88062),Q=n(56811),j=n(35344),F=n(50186),H=n(42342),q=n(73716),_=n(55024),ne=n(76804),R=n(96856),U=n(51343),de=n(75923),ee=n(10851),b=n(37739),C=n(58037),M=n(49311),B=n(36717),p=n(14496),S=n(77543),te=n(47808),ae=n(61504),N=n(68833);const se=({units:t,icon:l})=>t?.length?t.length>1?e.createElement(C.u,{placement:"top",content:e.createElement(b.K,{direction:"column"},t?.map(r=>e.createElement("span",{key:r.name},r.name)))},e.createElement(E,{icon:l},t.length)):e.createElement(E,{icon:l},t[0].name):null,E=(0,e.forwardRef)(({children:t,icon:l},r)=>e.createElement(N.x,{ref:r,display:"flex",alignItems:"center",marginRight:1},e.createElement(M.J,{name:l})," ",e.createElement(N.x,{marginLeft:1},t)));E.displayName="TooltipContent";const A=({users:t,showPaging:l,totalPages:r,onChangePage:v,currentPage:g,fetchData:d})=>{const X=(0,e.useMemo)(()=>t.some(c=>c.licensedRole),[t]),Oe=(0,e.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:c}})=>c&&e.createElement(ee.q,{src:c,alt:"User avatar"})},{id:"login",header:"Login",cell:({cell:{value:c}})=>c,sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:c}})=>c,sortType:"string"},{id:"name",header:"Name",cell:({cell:{value:c}})=>c,sortType:"string"},{id:"orgs",header:"Belongs to",cell:({cell:{value:c,row:k}})=>e.createElement(b.K,{alignItems:"center"},e.createElement(se,{units:c,icon:"building"}),k.original.isAdmin&&e.createElement(C.u,{placement:"top",content:"Grafana Admin"},e.createElement(M.J,{name:"shield"}))),sortType:(c,k)=>(c.original.orgs?.length||0)-(k.original.orgs?.length||0)},...X?[{id:"licensedRole",header:"Licensed role",cell:({cell:{value:c}})=>c==="None"?e.createElement(B.x,{color:"disabled"},"Not assigned"," ",e.createElement(C.u,{placement:"top",content:"A licensed role will be assigned when this user signs in"},e.createElement(M.J,{name:"question-circle"}))):c,sortType:"string"}]:[],{id:"lastSeenAtAge",header:"Last active",headerTooltip:{content:"Time since user was seen using Grafana",iconName:"question-circle"},cell:({cell:{value:c}})=>e.createElement(e.Fragment,null,c&&e.createElement(e.Fragment,null,c==="10 years"?e.createElement(B.x,{color:"disabled"},"Never"):c)),sortType:(c,k)=>new Date(c.original.lastSeenAt).getTime()-new Date(k.original.lastSeenAt).getTime()},{id:"authLabels",header:"Origin",cell:({cell:{value:c}})=>e.createElement(e.Fragment,null,Array.isArray(c)&&c.length>0&&e.createElement(ae.e,{label:c[0],removeIcon:!1,count:0}))},{id:"isDisabled",header:"",cell:({cell:{value:c}})=>e.createElement(e.Fragment,null,c&&e.createElement(p.V,{colorIndex:9,name:"Disabled"}))},{id:"edit",header:"",cell:({row:{original:c}})=>e.createElement("a",{href:`admin/users/edit/${c.id}`,"aria-label":`Edit team ${c.name}`},e.createElement(C.u,{content:"Edit user"},e.createElement(M.J,{name:"pen"})))}],[X]);return e.createElement(b.K,{direction:"column",gap:2},e.createElement(S.e,{columns:Oe,data:t,getRowId:c=>String(c.id),fetchData:d}),l&&e.createElement(b.K,{justifyContent:"flex-end"},e.createElement(te.t,{numberOfPages:r,currentPage:g,onNavigate:v})))};var P=n(64175);const V=[],re=t=>{V.push(t)},le=L.wl.pages.UserListPage.UserListAdminPage,oe={fetchUsers:P.uh,changeQuery:P.R5,changePage:P.oO,changeFilter:P.M6,changeSort:P.nt},i=t=>({users:t.userListAdmin.users,query:t.userListAdmin.query,showPaging:t.userListAdmin.showPaging,totalPages:t.userListAdmin.totalPages,page:t.userListAdmin.page,filters:t.userListAdmin.filters}),J=(0,_.connect)(i,oe)(({fetchUsers:t,query:l,changeQuery:r,users:v,showPaging:g,changeFilter:d,filters:X,totalPages:Oe,page:c,changePage:k,changeSort:Ke})=>{const ve=(0,T.wW)(Re);return(0,e.useEffect)(()=>{t()},[t]),e.createElement(F.T.Contents,null,e.createElement("div",{className:ve.actionBar,"data-testid":le.container},e.createElement("div",{className:ve.row},e.createElement(ne.H,{placeholder:"Search user by login, email, or name.",autoFocus:!0,value:l,onChange:r}),e.createElement(R.S,{options:[{label:"All users",value:!1},{label:"Active last 30 days",value:!0}],onChange:me=>d({name:"activeLast30Days",value:me}),value:X.find(me=>me.name==="activeLast30Days")?.value,className:ve.filter}),V.map((me,$e)=>e.createElement(me,{key:$e,filters:X,onChange:d,className:ve.filter})),de.Vt.hasPermission(H.AccessControlAction.UsersCreate)&&e.createElement(U.Qj,{href:"admin/users/create",variant:"primary"},"New user"))),e.createElement(A,{users:v,showPaging:g,totalPages:Oe,onChangePage:k,currentPage:c,fetchData:Ke}))});function xe(){return React.createElement(Page,{navId:"global-users"},React.createElement(J,null))}const Re=t=>({filter:(0,a.css)({margin:t.spacing(0,1),[t.breakpoints.down("sm")]:{margin:0}}),actionBar:(0,a.css)({marginBottom:t.spacing(2),display:"flex",alignItems:"flex-start",gap:t.spacing(2),[t.breakpoints.down("sm")]:{flexWrap:"wrap"}}),row:(0,a.css)({display:"flex",alignItems:"flex-start",textAlign:"left",marginBottom:t.spacing(.5),flexGrow:1,[t.breakpoints.down("sm")]:{flexWrap:"wrap",gap:t.spacing(2),width:"100%"}})}),Be=null;var fe=n(50248),ye=n(87484);const Ue=t=>{if(!t.includes(" "))return{browser:t,computer:""};const l=t.split(" ");return{browser:l[0],computer:l[1]}},ge=(t,l)=>t.length>l?t.substring(0,l)+"...":t,ue=({value:t})=>{const l=Ue(t);return e.createElement(C.u,{theme:"info-alt",content:t,placement:"top-end",interactive:!0},e.createElement("span",null,ge(l.browser,10),ge(l.computer,10)))},Ee=({devices:t})=>{const l=(0,e.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:r}})=>r&&e.createElement(ee.q,{src:r,alt:"User avatar"})},{id:"login",header:"Login",cell:({cell:{value:r}})=>"Anonymous"},{id:"userAgent",header:"User Agent",cell:({cell:{value:r}})=>e.createElement(ue,{value:r}),sortType:"string"},{id:"lastSeenAt",header:"Last active",cell:({cell:{value:r}})=>r,sortType:(r,v)=>new Date(r.original.updatedAt).getTime()-new Date(v.original.updatedAt).getTime()},{id:"clientIp",header:"Origin IP (address)",cell:({cell:{value:r}})=>r&&e.createElement(fe.C,{text:r,color:"orange"})}],[]);return e.createElement(b.K,{direction:"column",gap:2},e.createElement(S.e,{columns:l,data:t,getRowId:r=>r.deviceId}),t.length===0&&e.createElement(ye.j,null,e.createElement("span",null,"No anonymous users found.")))},pe={fetchUsersAnonymousDevices:P.xP},s=t=>({devices:t.userListAnonymousDevices.devices}),f=(0,_.connect)(s,pe)(({devices:t,fetchUsersAnonymousDevices:l})=>((0,e.useEffect)(()=>{l()},[l]),e.createElement(F.T.Contents,null,e.createElement(Ee,{devices:t}))));function I(){return React.createElement(Page,{navId:"anonymous-users"},React.createElement(f,null))}const w=null;var W=n(79106),O=n(86561),K=n(5572),G=n(61375),$=n(58947);const Ae=L.wl.pages.UserListPage.UsersListPublicDashboardsPage.DashboardsListModal,Le=({email:t,onDismiss:l})=>{const r=(0,T.wW)(De),{data:v,isLoading:g}=(0,O.Bl)(t);return e.createElement(K.u,{className:r.modal,isOpen:!0,title:"Public dashboards",onDismiss:l},g?e.createElement("div",{className:r.loading},e.createElement(G.u,{text:"Loading..."})):v?.map(d=>e.createElement("div",{key:d.dashboardUid,className:r.listItem,"data-testid":Ae.listItem(d.dashboardUid)},e.createElement("p",{className:r.dashboardTitle},d.dashboardTitle),e.createElement("div",{className:r.urlsContainer},e.createElement("a",{rel:"noreferrer",target:"_blank",className:(0,a.cx)("external-link",r.url),href:(0,j._M)(d.publicDashboardAccessToken),onClick:l},"Public dashboard URL"),e.createElement("span",{className:r.urlsDivider},"\u2022"),e.createElement("a",{className:(0,a.cx)("external-link",r.url),href:(0,j.Ez)(d.dashboardUid,d.slug),onClick:l},"Public dashboard settings")),e.createElement("hr",{className:r.divider}))))},ce=({email:t})=>e.createElement($.JY,null,({showModal:l,hideModal:r})=>e.createElement(U.zx,{variant:"secondary",size:"sm",icon:"question-circle",title:"Open dashboards list","aria-label":"Open dashboards list",onClick:()=>l(Le,{email:t,onDismiss:r})})),De=t=>({modal:(0,a.css)`
    width: 590px;
  `,loading:(0,a.css)`
    display: flex;
    justify-content: center;
  `,listItem:(0,a.css)`
    display: flex;
    flex-direction: column;
    gap: ${t.spacing(.5)};
  `,divider:(0,a.css)`
    margin: ${t.spacing(1.5,0)};
    color: ${t.colors.text.secondary};
  `,urlsContainer:(0,a.css)`
    display: flex;
    gap: ${t.spacing(.5)};

    ${t.breakpoints.down("sm")} {
      flex-direction: column;
    }
  `,urlsDivider:(0,a.css)`
    color: ${t.colors.text.secondary};
    ${t.breakpoints.down("sm")} {
      display: none;
    }
  `,dashboardTitle:(0,a.css)`
    font-size: ${t.typography.body.fontSize};
    font-weight: ${t.typography.fontWeightBold};
    margin-bottom: 0;
  `,url:(0,a.css)`
    font-size: ${t.typography.body.fontSize};
  `}),he=({user:t,hideModal:l})=>{const[r]=(0,O.NN)(),v=(0,T.wW)(be),g=()=>{r({email:t.email}),l()};return e.createElement(K.u,{className:v.modal,isOpen:!0,title:"Revoke access",onDismiss:l},e.createElement("p",{className:v.description},"Are you sure you want to revoke access for ",t.email,"?"),e.createElement("p",{className:v.description},"This action will immediately revoke ",t.email,"'s access to all public dashboards."),e.createElement(K.u.ButtonRow,null,e.createElement(U.zx,{type:"button",variant:"secondary",onClick:l,fill:"outline"},"Cancel"),e.createElement(U.zx,{type:"button",variant:"destructive",onClick:g},"Revoke access")))},Te=({user:t})=>e.createElement($.JY,null,({showModal:l,hideModal:r})=>e.createElement(U.zx,{size:"sm",variant:"destructive",onClick:()=>l(he,{user:t,hideModal:r}),icon:"times","aria-label":"Delete user",title:"Delete user"})),be=t=>({modal:(0,a.css)`
    width: 500px;
  `,description:(0,a.css)`
    font-size: ${t.typography.body.fontSize};
    margin: 0;
  `}),Ce=L.wl.pages.UserListPage.publicDashboards,Ie=()=>{const{data:t,isLoading:l}=(0,O.jI)();return e.createElement(F.T.Contents,{isLoading:l},e.createElement("table",{className:"filter-table form-inline","data-testid":Ce.container},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"Email"),e.createElement("th",null,e.createElement("span",null,"Activated "),e.createElement(C.u,{placement:"top",content:"Earliest time user has been an active user to a dashboard"},e.createElement(M.J,{name:"question-circle"}))),e.createElement("th",null,"Last active"),e.createElement("th",null,"Origin"),e.createElement("th",null,"Role"),e.createElement("th",null))),e.createElement("tbody",null,t?.map(r=>e.createElement("tr",{key:r.email},e.createElement("td",{className:"max-width-10"},e.createElement("span",{className:"ellipsis",title:r.email},r.email)),e.createElement("td",{className:"max-width-10"},r.firstSeenAtAge),e.createElement("td",{className:"max-width-10"},r.lastSeenAtAge),e.createElement("td",{className:"max-width-10"},e.createElement(W.Lh,{spacing:"sm"},e.createElement("span",null,r.totalDashboards," dashboard(s)"),e.createElement(ce,{email:r.email}))),e.createElement("td",{className:"max-width-10"},e.createElement(p.V,{name:"Viewer",colorIndex:19})),e.createElement("td",{className:"text-right"},e.createElement(Te,{user:r})))))))};var ie=(t=>(t.ADMIN="admin",t.ORG="org",t.PUBLIC_DASHBOARDS="public-dashboards",t.ANON="anon",t))(ie||{});const Z=L.wl.pages.UserListPage,Me=({view:t,setView:l})=>e.createElement(u.O,{label:"Public dashboard users",active:t==="public-dashboards",onChangeTab:()=>l("public-dashboards"),"data-testid":Z.tabs.publicDashboardsUsers}),Se={admin:e.createElement(J,null),org:e.createElement(q.UsersListPageContent,null),["public-dashboards"]:e.createElement(Ie,null),anon:e.createElement(f,null)};function Ne(){const t=(0,T.wW)(We),l=Q.contextSrv.hasPermission(H.AccessControlAction.UsersRead),r=Q.contextSrv.hasPermission(H.AccessControlAction.OrgUsersRead),v=(0,j.k3)()&&!!D.config.featureToggles.publicDashboardsEmailSharing&&(0,y.v)("publicDashboardsEmailSharing"),[g,d]=(0,e.useState)(()=>l?"admin":r?"org":null),X=r&&l;return e.createElement(F.T,{navId:"global-users"},X?e.createElement(z.J,{className:t.tabsMargin},e.createElement(u.O,{label:"All users",active:g==="admin",onChangeTab:()=>d("admin"),"data-testid":Z.tabs.allUsers}),e.createElement(u.O,{label:"Organization users",active:g==="org",onChangeTab:()=>d("org"),"data-testid":Z.tabs.orgUsers}),D.config.anonymousEnabled&&D.config.featureToggles.displayAnonymousStats&&e.createElement(u.O,{label:"Anonymous devices",active:g==="anon",onChangeTab:()=>d("anon"),"data-testid":Z.tabs.anonUserDevices}),v&&e.createElement(Me,{view:g,setView:d})):v&&e.createElement(z.J,{className:t.tabsMargin},e.createElement(u.O,{label:"Users",active:g==="org",onChangeTab:()=>d("org"),"data-testid":Z.tabs.users}),e.createElement(Me,{view:g,setView:d})),g?Se[g]:e.createElement(q.UsersListPageContent,null))}const We=t=>({tabsMargin:(0,a.css)({marginBottom:t.spacing(3)})})},66918:(Pe,x,n)=>{n.d(x,{q:()=>M});var a=n(31733),e=n(21568),L=n(10851),D=n(68833),y=n(58037),u=n(49311),T=n(14496),z=n(51343),Q=n(37739),j=n(77543),F=n(47808),H=n(90069),q=n(17806),_=n(59256),ne=n(61504),R=n(75923),U=n(42342),de=n(48334);const ee=`This user's role is not editable because it is synchronized from your auth provider.
Refer to the Grafana authentication docs for details.`,b=B=>{const p=B?.isExternallySynced;return!R.Vt.hasPermissionInMetadata(U.AccessControlAction.OrgUsersWrite,B)||p},C=e.wl.pages.UserListPage.UsersListPage,M=({users:B,orgId:p,onRoleChange:S,onRemoveUser:te,fetchData:ae,changePage:N,page:se,totalPages:E,rolesLoading:A})=>{const[P,V]=(0,a.useState)(null),[re,le]=(0,a.useState)([]);(0,a.useEffect)(()=>{async function i(){try{if(R.Vt.hasPermission(U.AccessControlAction.ActionRolesList)){let h=await(0,_.ul)(p);le(h)}}catch{console.error("Error loading options")}}R.Vt.licensedAccessControlEnabled()&&i()},[p]);const oe=(0,a.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:i}})=>i&&a.createElement(L.q,{src:i,alt:"User avatar"})},{id:"login",header:"Login",cell:({cell:{value:i}})=>a.createElement("div",null,i),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:i}})=>i,sortType:"string"},{id:"name",header:"Name",cell:({cell:{value:i}})=>i,sortType:"string"},{id:"lastSeenAtAge",header:"Last active",cell:({cell:{value:i}})=>i,sortType:(i,h)=>new Date(i.original.lastSeenAt).getTime()-new Date(h.original.lastSeenAt).getTime()},{id:"role",header:"Role",cell:({cell:{value:i},row:{original:h}})=>{const Y=b(h);return R.Vt.licensedAccessControlEnabled()?a.createElement(q.R,{userId:h.userId,roles:h.roles||[],isLoading:A,orgId:p,roleOptions:re,basicRole:i,onBasicRoleChange:J=>S(J,h),basicRoleDisabled:Y,basicRoleDisabledMessage:ee,width:40}):a.createElement(de.A,{"aria-label":"Role",value:i,disabled:Y,onChange:J=>S(J,h)})}},{id:"info",header:"",cell:({row:{original:i}})=>b(i)&&a.createElement(D.x,{display:"flex",alignItems:"center",marginLeft:1},a.createElement(y.u,{interactive:!0,content:a.createElement("div",null,"This user's role is not editable because it is synchronized from your auth provider. Refer to the\xA0",a.createElement("a",{href:"https://grafana.com/docs/grafana/latest/administration/user-management/manage-org-users/#change-a-users-organization-permissions",rel:"noreferrer",target:"_blank"},"Grafana authentication docs"),"\xA0for details.")},a.createElement(u.J,{name:"question-circle"})))},{id:"authLabels",header:"Origin",cell:({cell:{value:i}})=>a.createElement(a.Fragment,null,Array.isArray(i)&&i.length>0&&a.createElement(ne.e,{label:i[0],removeIcon:!1,count:0}))},{id:"isDisabled",header:"",cell:({cell:{value:i}})=>a.createElement(a.Fragment,null,i&&a.createElement(T.V,{colorIndex:9,name:"Disabled"}))},{id:"delete",header:"",cell:({row:{original:i}})=>R.Vt.hasPermissionInMetadata(U.AccessControlAction.OrgUsersRemove,i)&&a.createElement(z.zx,{size:"sm",variant:"destructive",onClick:()=>{V(i)},icon:"times","aria-label":`Delete user ${i.name}`})}],[A,p,re,S]);return a.createElement(Q.K,{direction:"column",gap:2,"data-testid":C.container},a.createElement(j.e,{columns:oe,data:B,getRowId:i=>String(i.userId),fetchData:ae}),a.createElement(Q.K,{justifyContent:"flex-end"},a.createElement(F.t,{onNavigate:N,currentPage:se,numberOfPages:E,hideWhenSinglePage:!0})),!!P&&a.createElement(H.s,{body:`Are you sure you want to delete user ${P?.login}?`,confirmText:"Delete",title:"Delete",onDismiss:()=>{V(null)},isOpen:!0,onConfirm:()=>{P&&(te(P),V(null))}}))}},87484:(Pe,x,n)=>{n.d(x,{j:()=>D});var a=n(76932),e=n(31733),L=n(76067);const D=({children:u})=>{const T=(0,L.wW)(y);return e.createElement("div",{className:T.container},u)},y=u=>({container:(0,a.css)`
      background-color: ${u.colors.background.secondary};
      color: ${u.colors.text.secondary};
      padding: ${u.spacing(4)};
      text-align: center;
    `})},73716:(Pe,x,n)=>{n.r(x),n.d(x,{UsersListPageContent:()=>Ee,UsersListPageUnconnected:()=>ue,default:()=>pe});var a=n(31733),e=n(55024),L=n(51133),D=n(50186),y=n(75923),u=n(66918),T=n(5334),z=n(51343),Q=n(35860);const j={revokeInvite:Q.GY},F=(0,e.connect)(null,j);class H extends a.PureComponent{render(){const{invitee:o,revokeInvite:m}=this.props;return a.createElement("tr",null,a.createElement("td",null,o.email),a.createElement("td",null,o.name),a.createElement("td",{className:"text-right"},a.createElement(T.m,{icon:"copy",variant:"secondary",size:"sm",getText:()=>o.url},"Copy Invite"),"\xA0"),a.createElement("td",null,a.createElement(z.zx,{variant:"destructive",size:"sm",icon:"times",onClick:()=>m(o.code),"aria-label":"Revoke Invite"})))}}const q=F(H);class _ extends a.PureComponent{render(){const{invitees:o}=this.props;return a.createElement("table",{className:"filter-table form-inline"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Email"),a.createElement("th",null,"Name"),a.createElement("th",null),a.createElement("th",{style:{width:"34px"}}))),a.createElement("tbody",{"data-testid":"InviteesTable-body"},o.map((m,f)=>a.createElement(q,{key:`${m.id}-${f}`,invitee:m}))))}}var ne=n(7261),R=n(33497);const{selectAll:U,selectById:de,selectTotal:ee}=R.selectors,b=(s,o)=>o,C=(0,ne.P1)([U,b],(s,o)=>{const m=new RegExp(o,"i");return s.filter(I=>m.test(I.name)||m.test(I.email))});var M=n(41164),B=n(76804),p=n(96856),S=n(83811),te=n(42342),ae=n(69781),N=n(69391),se=n(10704),E=n(79850);function A(){return async(s,o)=>{try{s((0,E.tZ)());const{perPage:m,page:f,searchQuery:I,sort:w}=o().users,W=await(0,N.i)().get("/api/org/users/search",(0,se.y)({perpage:m,page:f,query:I,sort:w}));if(y.Vt.licensedAccessControlEnabled()&&y.Vt.hasPermission(te.AccessControlAction.ActionUserRolesList)){s((0,E.Fy)());const O=y.Vt.user.orgId,K=W?.orgUsers.map($=>$.userId),G=await(0,N.i)().post("/api/access-control/users/roles/search",{userIds:K,orgId:O});W.orgUsers.forEach($=>{$.roles=G?G[$.userId]||[]:[]}),s((0,E.BR)())}s((0,E.eT)(W))}catch{(0,E.k7)()}}}const P=(0,ae.debounce)(s=>s(A()),300);function V(s){return async o=>{await(0,N.i)().patch(`/api/org/users/${s.userId}`,{role:s.role}),o(A())}}function re(s){return async o=>{await(0,N.i)().delete(`/api/org/users/${s}`),o(A())}}function le(s){return async o=>{o((0,E.PJ)(s)),o(A())}}function oe({sortBy:s}){const o=s.length?`${s[0].id}-${s[0].desc?"desc":"asc"}`:void 0;return async m=>{m((0,E.UL)(o)),m(A())}}function i(s){return async o=>{o((0,E.w4)(s)),P(o)}}const h=s=>{const o=new RegExp(s.searchQuery,"i");return s.users.filter(m=>o.test(m.login)||o.test(m.email)||o.test(m.name))},Y=s=>s.searchQuery;function J(s){return{searchQuery:Y(s.users),pendingInvitesCount:ee(s.invites),externalUserMngLinkName:s.users.externalUserMngLinkName,externalUserMngLinkUrl:s.users.externalUserMngLinkUrl}}const xe={changeSearchQuery:i},fe=(0,e.connect)(J,xe)(({externalUserMngLinkName:s,externalUserMngLinkUrl:o,searchQuery:m,pendingInvitesCount:f,changeSearchQuery:I,onShowInvites:w,showInvites:W})=>{const O=[{label:"Users",value:"users"},{label:`Pending Invites (${f})`,value:"invites"}],G=y.Vt.hasPermission(te.AccessControlAction.OrgUsersAdd)&&!(S.default.disableLoginForm&&S.default.externalUserMngInfo);return a.createElement("div",{className:"page-action-bar","data-testid":"users-action-bar"},a.createElement(M._,{grow:!0},a.createElement(B.H,{value:m,onChange:I,placeholder:"Search user by login, email or name"})),f>0&&a.createElement("div",{style:{marginLeft:"1rem"}},a.createElement(p.S,{value:W?"invites":"users",options:O,onChange:w})),G&&a.createElement(z.Qj,{href:"org/users/invite"},"Invite"),o&&a.createElement(z.Qj,{href:o,target:"_blank",rel:"noopener"},s))});function ye(s){const o=Y(s.users);return{users:h(s.users),searchQuery:Y(s.users),page:s.users.page,totalPages:s.users.totalPages,perPage:s.users.perPage,invitees:C(s.invites,o),externalUserMngInfo:s.users.externalUserMngInfo,isLoading:s.users.isLoading,rolesLoading:s.users.rolesLoading}}const Ue={loadUsers:A,fetchInvitees:Q.nW,changePage:le,changeSort:oe,updateUser:V,removeUser:re},ge=(0,e.connect)(ye,Ue),ue=({users:s,page:o,totalPages:m,invitees:f,externalUserMngInfo:I,isLoading:w,rolesLoading:W,loadUsers:O,fetchInvitees:K,changePage:G,updateUser:$,removeUser:Ae,changeSort:Le})=>{const[ce,De]=(0,a.useState)(!1),he=I?(0,L.a)(I):"";(0,a.useEffect)(()=>{O(),K()},[K,O]);const Te=(ie,Z)=>{$({...Z,role:ie})},be=ie=>Ae(ie.userId),Ce=()=>{De(!ce)},Ie=()=>ce?a.createElement(_,{invitees:f}):a.createElement(u.q,{users:s,orgId:y.Vt.user.orgId,rolesLoading:W,onRoleChange:Te,onRemoveUser:be,fetchData:Le,changePage:G,page:o,totalPages:m});return a.createElement(D.T.Contents,{isLoading:!w},a.createElement(fe,{onShowInvites:Ce,showInvites:ce}),he&&a.createElement("div",{className:"grafana-info-box",dangerouslySetInnerHTML:{__html:he}}),w&&Ie())},Ee=ge(ue);function pe(){return a.createElement(D.T,{navId:"users"},a.createElement(Ee,null))}}}]);

//# sourceMappingURL=UserListPage.301510305c9310c54041.js.map