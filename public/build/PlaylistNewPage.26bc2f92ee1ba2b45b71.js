"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9975],{29821:(O,E,t)=>{t.d(E,{H:()=>J});var e=t(31733),g=t(21568),h=t(85498),D=t(17618),m=t(85765),p=t(64516),b=t(97216),A=t(79106),P=t(51343),T=t(66368),x=t(41374),s=t(53166),S=t(4502),B=t(4113),I=t(76932),F=t(86504),N=t.n(F),K=t(76067),$=t(89719),M=t(49311),R=t(41354),U=t(61504);const L=({items:d,onDelete:l})=>{const o=(0,K.wW)(W);if(!d?.length)return e.createElement("div",null,e.createElement("em",null,e.createElement(s.cC,{i18nKey:"playlist-edit.form.table-empty"},"Playlist is empty. Add dashboards below.")));const y=a=>{let c=a.type==="dashboard_by_tag"?"apps":"tag-alt";const r=[],n=a.dashboards?.[0];return a.dashboards?a.type==="dashboard_by_tag"?(r.push(e.createElement(U.e,{key:a.value,label:a.value,removeIcon:!1,count:0})),n?r.push(e.createElement("span",{key:"info"},"\xA0 ",N()("dashboard",a.dashboards.length,!0))):(c="exclamation-triangle",r.push(e.createElement("span",{key:"info"},"\xA0 No dashboards found")))):n?r.push(a.dashboards.length>1?e.createElement("span",{key:"info"},"Multiple items found: $",a.value):e.createElement("span",{key:"info"},n.name??a.value)):(c="exclamation-triangle",r.push(e.createElement("span",{key:"info"},"\xA0 Not found: ",a.value))):r.push(e.createElement($.$,{key:"spinner"})),e.createElement(e.Fragment,null,e.createElement(M.J,{name:c,className:o.rightMargin,key:"icon"}),r)};return e.createElement(e.Fragment,null,d.map((a,c)=>e.createElement(B._l,{key:`${c}/${a.value}`,draggableId:`${c}`,index:c},r=>e.createElement("div",{className:o.row,ref:r.innerRef,...r.draggableProps,...r.dragHandleProps,role:"row"},e.createElement("div",{className:o.actions,role:"cell","aria-label":`Playlist item, ${a.type}, ${a.value}`},y(a)),e.createElement("div",{className:o.actions},e.createElement(R.h,{name:"times",size:"md",onClick:()=>l(c),"data-testid":g.wl.pages.PlaylistForm.itemDelete,tooltip:(0,s.t)("playlist-edit.form.table-delete","Delete playlist item")}),e.createElement(M.J,{title:(0,s.t)("playlist-edit.form.table-drag","Drag and drop to reorder"),name:"draggabledots",size:"md"}))))))};function W(d){return{row:(0,I.css)`
      padding: 6px;
      background: ${d.colors.background.secondary};
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 3px;

      border: 1px solid ${d.colors.border.medium};
      &:hover {
        border: 1px solid ${d.colors.border.strong};
      }
    `,rightMargin:(0,I.css)`
      margin-right: 5px;
    `,actions:(0,I.css)`
      align-items: center;
      justify-content: center;
      display: flex;
    `,settings:(0,I.css)`
      label: settings;
      text-align: right;
    `}}const j=({items:d,deleteItem:l,moveItem:o})=>{const y=a=>{a.destination&&o(a.source.index,a.destination?.index)};return e.createElement(b.C,{label:(0,s.t)("playlist-edit.form.table-heading","Dashboards")},e.createElement(B.Z5,{onDragEnd:y},e.createElement(B.bK,{droppableId:"playlist-list",direction:"vertical"},a=>e.createElement("div",{ref:a.innerRef,...a.droppableProps},e.createElement(L,{items:d,onDelete:l}),a.placeholder))))};var z=t(59326),H=t(81039);function V(d){const[l,o]=(0,e.useState)(d??[]);(0,z.Z)(async()=>{for(const n of l)if(!n.dashboards){o(await(0,H.jc)(l));return}},[l]);const y=(0,e.useCallback)(n=>{n&&o([...l,{type:"dashboard_by_uid",value:n.uid}])},[l]),a=(0,e.useCallback)(n=>{const i=n[0];if(!i||l.find(v=>v.value===i))return;const u={type:"dashboard_by_tag",value:i};o([...l,u])},[l]),c=(0,e.useCallback)((n,i)=>{if(n===i||!l[n])return;const u=Array.from(l),[v]=u.splice(n,1);u.splice(i,0,v),o(u)},[l]),r=(0,e.useCallback)(n=>{const i=l.slice();i.splice(n,1),o(i)},[l]);return{items:l,addByUID:y,addByTag:a,deleteItem:r,moveItem:c}}const J=({onSubmit:d,playlist:l})=>{const[o,y]=(0,e.useState)(!1),{name:a,interval:c,items:r}=l,n=(0,e.useMemo)(()=>()=>(0,S.getGrafanaSearcher)().tags({kind:["dashboard"]}),[]),{items:i,addByUID:u,addByTag:v,deleteItem:Z,moveItem:G}=V(r),Q=C=>{y(!0),d({...C,items:i,uid:l.uid})};return e.createElement("div",null,e.createElement(D.l,{onSubmit:Q,validateOn:"onBlur"},({register:C,errors:f})=>{const X=i.length===0||Object.keys(f).length>0;return e.createElement(e.Fragment,null,e.createElement(m.g,{label:(0,s.t)("playlist-edit.form.name-label","Name"),invalid:!!f.name,error:f?.name?.message},e.createElement(p.I,{type:"text",...C("name",{required:(0,s.t)("playlist-edit.form.name-required","Name is required")}),placeholder:(0,s.t)("playlist-edit.form.name-placeholder","Name"),defaultValue:a,"aria-label":g.wl.pages.PlaylistForm.name})),e.createElement(m.g,{label:(0,s.t)("playlist-edit.form.interval-label","Interval"),invalid:!!f.interval,error:f?.interval?.message},e.createElement(p.I,{type:"text",...C("interval",{required:(0,s.t)("playlist-edit.form.interval-required","Interval is required")}),placeholder:(0,s.t)("playlist-edit.form.interval-placeholder","5m"),defaultValue:c??"5m","aria-label":g.wl.pages.PlaylistForm.interval})),e.createElement(j,{items:i,deleteItem:Z,moveItem:G}),e.createElement(b.C,{label:(0,s.t)("playlist-edit.form.heading","Add dashboards")},e.createElement(m.g,{label:(0,s.t)("playlist-edit.form.add-title-label","Add by title")},e.createElement(T.o,{id:"dashboard-picker",onChange:u,key:i.length})),e.createElement(m.g,{label:(0,s.t)("playlist-edit.form.add-tag-label","Add by tag")},e.createElement(x.D,{isClearable:!0,tags:[],hideValues:!0,tagOptions:n,onChange:v,placeholder:(0,s.t)("playlist-edit.form.add-tag-placeholder","Select a tag")}))),e.createElement(A.Lh,null,e.createElement(P.zx,{type:"submit",variant:"primary",disabled:X,icon:o?"spinner":void 0},e.createElement(s.cC,{i18nKey:"playlist-edit.form.save"},"Save")),e.createElement(P.Qj,{variant:"secondary",href:`${h.config.appSubUrl}/playlists`},e.createElement(s.cC,{i18nKey:"playlist-edit.form.cancel"},"Cancel"))))}))}},32543:(O,E,t)=>{t.r(E),t.d(E,{PlaylistNewPage:()=>p,default:()=>b});var e=t(31733),g=t(19690),h=t(50186),D=t(29821),m=t(81039);const p=()=>{const[A]=(0,e.useState)((0,m.d5)()),P=async x=>{await(0,m.K9)().createPlaylist(x),g.E1.push("/playlists")},T={text:"New playlist",subTitle:"A playlist rotates through a pre-selected list of dashboards. A playlist can be a great way to build situational awareness, or just show off your metrics to your team or visitors."};return e.createElement(h.T,{navId:"dashboards/playlists",pageNav:T},e.createElement(h.T.Contents,null,e.createElement(D.H,{onSubmit:P,playlist:A})))},b=p}}]);

//# sourceMappingURL=PlaylistNewPage.26bc2f92ee1ba2b45b71.js.map